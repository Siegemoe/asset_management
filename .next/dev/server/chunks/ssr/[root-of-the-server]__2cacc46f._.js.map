{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/asset_management/src/lib/security/simpleAuditLogger.ts"],"sourcesContent":["// Simple Audit Logger - works with existing schema\r\n// import { prisma } from \"@/lib/prisma\" // Not used in current implementation\r\n\r\nexport interface AuditEvent {\r\n  id: string\r\n  userId?: string | undefined\r\n  action: string\r\n  resource?: string\r\n  details?: Record<string, any>\r\n  ipAddress?: string | undefined\r\n  userAgent?: string | undefined\r\n  severity?: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL'\r\n  eventType?: string\r\n  description?: string\r\n  createdAt: Date\r\n}\r\n\r\n// In-memory store for audit events (in production, this would be a database)\r\n// Start with empty store - no placeholder data\r\nconst auditEventsStore: AuditEvent[] = []\r\n\r\nexport class SimpleAuditLogger {\r\n  private static generateId(): string {\r\n    return `audit_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n  }\r\n\r\n  /**\r\n   * Log a login attempt (both success and failure)\r\n   */\r\n  static async logLoginAttempt(\r\n    userId: string | undefined,\r\n    email: string,\r\n    success: boolean,\r\n    ipAddress?: string,\r\n    userAgent?: string,\r\n    reason?: string\r\n  ) {\r\n    try {\r\n      const event: AuditEvent = {\r\n        id: this.generateId(),\r\n        eventType: success ? 'LOGIN_SUCCESS' : 'LOGIN_FAILURE',\r\n        action: 'login',\r\n        description: success ? 'Successful login' : 'Failed login attempt',\r\n        userId,\r\n        severity: success ? 'LOW' : 'MEDIUM',\r\n        ipAddress,\r\n        userAgent,\r\n        createdAt: new Date()\r\n      }\r\n\r\n      auditEventsStore.unshift(event)\r\n      // Keep only the last 1000 events\r\n      if (auditEventsStore.length > 1000) {\r\n        auditEventsStore.splice(1000)\r\n      }\r\n\r\n      console.log('AUDIT:', event)\r\n    } catch (error) {\r\n      console.error('Failed to log login attempt:', error)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log logout\r\n   */\r\n  static async logLogout(\r\n    userId: string,\r\n    ipAddress?: string,\r\n    userAgent?: string\r\n  ) {\r\n    const event: AuditEvent = {\r\n      id: this.generateId(),\r\n      eventType: 'LOGOUT',\r\n      action: 'logout',\r\n      description: 'User logout',\r\n      userId,\r\n      severity: 'LOW',\r\n      ipAddress,\r\n      userAgent,\r\n      createdAt: new Date()\r\n    }\r\n\r\n    auditEventsStore.unshift(event)\r\n    if (auditEventsStore.length > 1000) {\r\n      auditEventsStore.splice(1000)\r\n    }\r\n\r\n    console.log('AUDIT:', event)\r\n  }\r\n\r\n  /**\r\n   * Log data access\r\n   */\r\n  static async logDataAccess(\r\n    userId: string,\r\n    resource: string,\r\n    action: 'read' | 'list' | 'search',\r\n    resourceId?: string,\r\n    ipAddress?: string,\r\n    userAgent?: string\r\n  ) {\r\n    const event: AuditEvent = {\r\n      id: this.generateId(),\r\n      eventType: 'DATA_ACCESS',\r\n      action: `${action}_${resource}`,\r\n      description: `User accessed ${resource} data`,\r\n      userId,\r\n      severity: 'LOW',\r\n      ipAddress,\r\n      userAgent,\r\n      createdAt: new Date()\r\n    }\r\n\r\n    auditEventsStore.unshift(event)\r\n    if (auditEventsStore.length > 1000) {\r\n      auditEventsStore.splice(1000)\r\n    }\r\n\r\n    console.log('AUDIT:', event)\r\n  }\r\n\r\n  /**\r\n   * Log data modification\r\n   */\r\n  static async logDataModification(\r\n    userId: string,\r\n    resource: string,\r\n    action: 'create' | 'update' | 'delete',\r\n    resourceId?: string,\r\n    changes?: Record<string, any>,\r\n    ipAddress?: string,\r\n    userAgent?: string\r\n  ) {\r\n    const event: AuditEvent = {\r\n      id: this.generateId(),\r\n      eventType: 'DATA_MODIFICATION',\r\n      action: `${action}_${resource}`,\r\n      description: `User ${action}ed ${resource}`,\r\n      userId,\r\n      severity: action === 'delete' ? 'MEDIUM' : 'LOW',\r\n      ipAddress,\r\n      userAgent,\r\n      createdAt: new Date()\r\n    }\r\n\r\n    auditEventsStore.unshift(event)\r\n    if (auditEventsStore.length > 1000) {\r\n      auditEventsStore.splice(1000)\r\n    }\r\n\r\n    console.log('AUDIT:', event)\r\n  }\r\n\r\n  /**\r\n   * Log security events\r\n   */\r\n  static async logSecurityEvent(\r\n    event: 'ACCOUNT_LOCKED' | 'PASSWORD_CHANGE' | 'UNAUTHORIZED_ACCESS',\r\n    userId: string,\r\n    details: Record<string, any> = {},\r\n    ipAddress?: string,\r\n    userAgent?: string\r\n  ) {\r\n    const auditEvent: AuditEvent = {\r\n      id: this.generateId(),\r\n      eventType: event,\r\n      action: 'security_event',\r\n      description: `${event} event occurred`,\r\n      userId,\r\n      severity: event === 'UNAUTHORIZED_ACCESS' ? 'HIGH' : 'MEDIUM',\r\n      details,\r\n      ipAddress,\r\n      userAgent,\r\n      createdAt: new Date()\r\n    }\r\n\r\n    auditEventsStore.unshift(auditEvent)\r\n    if (auditEventsStore.length > 1000) {\r\n      auditEventsStore.splice(1000)\r\n    }\r\n\r\n    console.log('SECURITY:', auditEvent)\r\n  }\r\n\r\n  /**\r\n   * Get recent events\r\n   */\r\n  static async getRecentEvents(limit: number = 100): Promise<AuditEvent[]> {\r\n    return auditEventsStore.slice(0, limit)\r\n  }\r\n\r\n  /**\r\n   * Get security events (high severity)\r\n   */\r\n  static async getSecurityEvents(limit: number = 50): Promise<AuditEvent[]> {\r\n    return auditEventsStore\r\n      .filter(event =>\r\n        event.severity === 'HIGH' ||\r\n        event.severity === 'CRITICAL' ||\r\n        event.eventType?.includes('SECURITY') ||\r\n        event.eventType === 'UNAUTHORIZED_ACCESS' ||\r\n        event.eventType === 'ACCOUNT_LOCKED'\r\n      )\r\n      .slice(0, limit)\r\n  }\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/asset_management/src/lib/security/sessionManager.ts"],"sourcesContent":["// Enhanced Session Management Service\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport { SimpleAuditLogger } from \"./simpleAuditLogger\"\r\n\r\nexport interface SessionConfig {\r\n  sessionTimeout: number // in minutes\r\n  maxConcurrentSessions: number\r\n  refreshTokenRotation: boolean\r\n  requireHTTPS: boolean\r\n  sessionFingerprinting: boolean\r\n}\r\n\r\nexport interface SessionInfo {\r\n  id: string\r\n  userId: string\r\n  sessionToken: string\r\n  refreshToken: string | undefined\r\n  deviceInfo: string | undefined\r\n  ipAddress: string | undefined\r\n  userAgent: string | undefined\r\n  createdAt: Date\r\n  lastActivity: Date\r\n  expiresAt: Date\r\n  status: 'active' | 'expired' | 'revoked'\r\n}\r\n\r\nexport class SessionManager {\r\n  private static config: SessionConfig = {\r\n    sessionTimeout: 30, // 30 minutes\r\n    maxConcurrentSessions: 3,\r\n    refreshTokenRotation: true,\r\n    requireHTTPS: true,\r\n    sessionFingerprinting: true,\r\n  }\r\n\r\n  // In-memory session storage (in production, this would be a database)\r\n  private static sessions: Map<string, SessionInfo> = new Map()\r\n\r\n  /**\r\n   * Create a new session\r\n   */\r\n  static async createSession(\r\n    userId: string,\r\n    sessionToken: string,\r\n    refreshToken?: string,\r\n    deviceInfo?: string,\r\n    ipAddress?: string,\r\n    userAgent?: string\r\n  ): Promise<SessionInfo> {\r\n    // Check concurrent session limit\r\n    await this.enforceSessionLimit(userId)\r\n\r\n    const expiresAt = new Date(Date.now() + this.config.sessionTimeout * 60 * 1000)\r\n\r\n    const now = new Date()\r\n    const sessionInfo: SessionInfo = {\r\n      id: `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      userId,\r\n      sessionToken,\r\n      refreshToken: refreshToken || undefined,\r\n      deviceInfo: deviceInfo || undefined,\r\n      ipAddress: ipAddress || undefined,\r\n      userAgent: userAgent || undefined,\r\n      createdAt: now,\r\n      lastActivity: now,\r\n      expiresAt,\r\n      status: 'active'\r\n    }\r\n\r\n    // Store session in memory\r\n    this.sessions.set(sessionToken, sessionInfo)\r\n\r\n    // Log session creation\r\n    await SimpleAuditLogger.logSecurityEvent('PASSWORD_CHANGE', userId, {\r\n      action: 'session_created',\r\n      sessionId: sessionInfo.id,\r\n      deviceInfo,\r\n      timestamp: new Date().toISOString()\r\n    }, ipAddress, userAgent)\r\n\r\n    // In a real implementation, you would store this in the database\r\n    console.log('SESSION_CREATED:', sessionInfo)\r\n\r\n    return sessionInfo\r\n  }\r\n\r\n  /**\r\n   * Validate and refresh session\r\n   */\r\n  static async validateSession(sessionToken: string, ipAddress?: string, userAgent?: string): Promise<{\r\n    valid: boolean\r\n    session?: SessionInfo\r\n    reason?: string\r\n  }> {\r\n    try {\r\n      const session = this.sessions.get(sessionToken)\r\n      \r\n      if (!session) {\r\n        return { valid: false, reason: 'Session not found' }\r\n      }\r\n\r\n      if (session.expiresAt < new Date()) {\r\n        session.status = 'expired'\r\n        this.sessions.set(sessionToken, session)\r\n        return { valid: false, reason: 'Session expired' }\r\n      }\r\n\r\n      if (session.status !== 'active') {\r\n        return { valid: false, reason: `Session ${session.status}` }\r\n      }\r\n\r\n      // Update last activity\r\n      session.lastActivity = new Date()\r\n      this.sessions.set(sessionToken, session)\r\n\r\n      return { valid: true, session }\r\n    } catch (error) {\r\n      console.error('Error validating session:', error)\r\n      return { valid: false, reason: 'Session validation failed' }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh session token\r\n   */\r\n  static async refreshSession(\r\n    refreshToken: string,\r\n    ipAddress?: string,\r\n    userAgent?: string\r\n  ): Promise<{\r\n    success: boolean\r\n    newSessionToken?: string\r\n    newRefreshToken?: string\r\n    reason?: string\r\n  }> {\r\n    try {\r\n      if (this.config.refreshTokenRotation) {\r\n        // Generate new tokens\r\n        const newSessionToken = this.generateSecureToken(32)\r\n        const newRefreshToken = this.generateSecureToken(32)\r\n\r\n        await SimpleAuditLogger.logSecurityEvent('PASSWORD_CHANGE', 'system', {\r\n          action: 'session_refreshed',\r\n          oldRefreshToken: refreshToken.substring(0, 8) + '...',\r\n          newRefreshToken: newRefreshToken.substring(0, 8) + '...',\r\n          timestamp: new Date().toISOString()\r\n        }, ipAddress, userAgent)\r\n\r\n        return {\r\n          success: true,\r\n          newSessionToken,\r\n          newRefreshToken\r\n        }\r\n      }\r\n\r\n      return { success: false, reason: 'Token rotation disabled' }\r\n    } catch (error) {\r\n      console.error('Error refreshing session:', error)\r\n      return { success: false, reason: 'Session refresh failed' }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Invalidate a session\r\n   */\r\n  static async invalidateSession(\r\n    sessionToken: string,\r\n    userId?: string,\r\n    reason: string = 'manual_invalidation',\r\n    ipAddress?: string,\r\n    userAgent?: string\r\n  ): Promise<{ success: boolean }> {\r\n    try {\r\n      const session = this.sessions.get(sessionToken)\r\n      \r\n      if (session) {\r\n        session.status = 'revoked'\r\n        this.sessions.set(sessionToken, session)\r\n      }\r\n\r\n      await SimpleAuditLogger.logSecurityEvent('PASSWORD_CHANGE', userId || 'system', {\r\n        action: 'session_invalidated',\r\n        reason,\r\n        sessionToken: sessionToken.substring(0, 8) + '...',\r\n        timestamp: new Date().toISOString()\r\n      }, ipAddress, userAgent)\r\n\r\n      return { success: true }\r\n    } catch (error) {\r\n      console.error('Error invalidating session:', error)\r\n      return { success: false }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Invalidate all sessions for a user\r\n   */\r\n  static async invalidateAllUserSessions(\r\n    userId: string,\r\n    reason: string = 'security_reason',\r\n    ipAddress?: string,\r\n    userAgent?: string\r\n  ): Promise<{ success: boolean; invalidatedCount: number }> {\r\n    try {\r\n      let invalidatedCount = 0\r\n      \r\n      for (const [token, session] of this.sessions.entries()) {\r\n        if (session.userId === userId && session.status === 'active') {\r\n          session.status = 'revoked'\r\n          this.sessions.set(token, session)\r\n          invalidatedCount++\r\n        }\r\n      }\r\n\r\n      await SimpleAuditLogger.logSecurityEvent('PASSWORD_CHANGE', userId, {\r\n        action: 'all_sessions_invalidated',\r\n        reason,\r\n        invalidatedCount,\r\n        timestamp: new Date().toISOString()\r\n      }, ipAddress, userAgent)\r\n\r\n      return { success: true, invalidatedCount }\r\n    } catch (error) {\r\n      console.error('Error invalidating all sessions:', error)\r\n      return { success: false, invalidatedCount: 0 }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all active sessions for a user\r\n   */\r\n  static async getUserSessions(userId: string): Promise<SessionInfo[]> {\r\n    try {\r\n      return Array.from(this.sessions.values())\r\n        .filter(session => session.userId === userId)\r\n        .sort((a, b) => b.lastActivity.getTime() - a.lastActivity.getTime())\r\n    } catch (error) {\r\n      console.error('Error getting user sessions:', error)\r\n      return []\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clean up expired sessions\r\n   */\r\n  static async cleanupExpiredSessions(): Promise<number> {\r\n    try {\r\n      const now = new Date()\r\n      let cleanedCount = 0\r\n      \r\n      for (const [token, session] of this.sessions.entries()) {\r\n        if (session.expiresAt < now || session.status === 'expired') {\r\n          this.sessions.delete(token)\r\n          cleanedCount++\r\n        }\r\n      }\r\n      \r\n      return cleanedCount\r\n    } catch (error) {\r\n      console.error('Error cleaning up expired sessions:', error)\r\n      return 0\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Enforce session limit per user\r\n   */\r\n  private static async enforceSessionLimit(userId: string): Promise<void> {\r\n    const userSessions = await this.getUserSessions(userId)\r\n    \r\n    if (userSessions.length >= this.config.maxConcurrentSessions) {\r\n      // Invalidate the oldest session\r\n      const oldestSession = userSessions.reduce((oldest, session) => \r\n        session.lastActivity < oldest.lastActivity ? session : oldest\r\n      )\r\n      \r\n      await this.invalidateSession(oldestSession.sessionToken, userId, 'concurrent_session_limit')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check for suspicious activity\r\n   */\r\n  static async checkSuspiciousActivity(\r\n    userId: string,\r\n    currentIpAddress: string,\r\n    currentUserAgent: string\r\n  ): Promise<{\r\n    suspicious: boolean\r\n    reasons: string[]\r\n  }> {\r\n    const reasons: string[] = []\r\n    let suspicious = false\r\n\r\n    try {\r\n      const sessions = await this.getUserSessions(userId)\r\n      \r\n      // Check for IP address changes\r\n      const ipAddresses = [...new Set(sessions.map(s => s.ipAddress))]\r\n      if (ipAddresses.length > 1 && !ipAddresses.includes(currentIpAddress)) {\r\n        reasons.push('Multiple IP addresses detected')\r\n        suspicious = true\r\n      }\r\n\r\n      // Check for new device/user agent\r\n      const userAgents = [...new Set(sessions.map(s => s.userAgent))]\r\n      if (userAgents.length > 1 && !userAgents.includes(currentUserAgent)) {\r\n        reasons.push('Multiple devices detected')\r\n        suspicious = true\r\n      }\r\n\r\n      // Check for rapid session creation\r\n      const recentSessions = sessions.filter(s => \r\n        Date.now() - s.createdAt.getTime() < 5 * 60 * 1000 // Last 5 minutes\r\n      )\r\n      if (recentSessions.length > this.config.maxConcurrentSessions) {\r\n        reasons.push('Rapid session creation detected')\r\n        suspicious = true\r\n      }\r\n\r\n      if (suspicious) {\r\n        await SimpleAuditLogger.logSecurityEvent('UNAUTHORIZED_ACCESS', userId, {\r\n          action: 'suspicious_activity',\r\n          reasons,\r\n          currentIpAddress,\r\n          currentUserAgent\r\n        }, currentIpAddress, currentUserAgent)\r\n      }\r\n\r\n      return { suspicious, reasons }\r\n    } catch (error) {\r\n      console.error('Error checking suspicious activity:', error)\r\n      return { suspicious: false, reasons: [] }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generate secure random token\r\n   */\r\n  private static generateSecureToken(length: number): string {\r\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\r\n    let token = ''\r\n    \r\n    for (let i = 0; i < length; i++) {\r\n      token += chars.charAt(Math.floor(Math.random() * chars.length))\r\n    }\r\n    \r\n    return token\r\n  }\r\n\r\n  /**\r\n   * Get session statistics\r\n   */\r\n  static async getSessionStats(): Promise<{\r\n    totalSessions: number\r\n    activeSessions: number\r\n    expiredSessions: number\r\n    averageSessionDuration: number\r\n  }> {\r\n    try {\r\n      const sessions = Array.from(this.sessions.values())\r\n      const now = new Date()\r\n      \r\n      const activeSessions = sessions.filter(s => s.status === 'active' && s.expiresAt > now).length\r\n      const expiredSessions = sessions.filter(s => s.status === 'expired' || s.expiresAt <= now).length\r\n      \r\n      // Calculate average duration for active sessions\r\n      const activeSessionDurations = sessions\r\n        .filter(s => s.status === 'active')\r\n        .map(s => now.getTime() - s.createdAt.getTime())\r\n      \r\n      const averageSessionDuration = activeSessionDurations.length > 0\r\n        ? activeSessionDurations.reduce((sum, duration) => sum + duration, 0) / activeSessionDurations.length\r\n        : 0\r\n      \r\n      return {\r\n        totalSessions: sessions.length,\r\n        activeSessions,\r\n        expiredSessions,\r\n        averageSessionDuration: Math.round(averageSessionDuration / 1000 / 60) // Convert to minutes\r\n      }\r\n    } catch (error) {\r\n      console.error('Error getting session stats:', error)\r\n      return {\r\n        totalSessions: 0,\r\n        activeSessions: 0,\r\n        expiredSessions: 0,\r\n        averageSessionDuration: 0\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update configuration\r\n   */\r\n  static updateConfig(newConfig: Partial<SessionConfig>) {\r\n    this.config = { ...this.config, ...newConfig }\r\n  }\r\n\r\n  /**\r\n   * Get current configuration\r\n   */\r\n  static getConfig(): SessionConfig {\r\n    return { ...this.config }\r\n  }\r\n}\r\n\r\n// SessionConfig and SessionInfo are already exported above"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 484, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/asset_management/src/app/login/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { signIn } from \"next-auth/react\"\r\nimport Link from \"next/link\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport { SessionManager } from \"@/lib/security/sessionManager\"\r\nimport { SimpleAuditLogger } from \"@/lib/security/simpleAuditLogger\"\r\n\r\ninterface ValidationErrors {\r\n  email?: string\r\n  password?: string\r\n  name?: string\r\n  general?: string\r\n}\r\n\r\ninterface ErrorMessage {\r\n  type: 'error' | 'warning' | 'success'\r\n  message: string\r\n}\r\n\r\nexport default function LoginPage() {\r\n  const router = useRouter()\r\n  const [isSignUp, setIsSignUp] = useState(false)\r\n  const [formData, setFormData] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n    name: \"\"\r\n  })\r\n  const [loading, setLoading] = useState(false)\r\n  const [validationErrors, setValidationErrors] = useState<ValidationErrors>({})\r\n  const [errorMessage, setErrorMessage] = useState<ErrorMessage | null>(null)\r\n  const [successMessage, setSuccessMessage] = useState<string | null>(null)\r\n\r\n  // Email validation\r\n  const isValidEmail = (email: string): boolean => {\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\r\n    return emailRegex.test(email)\r\n  }\r\n\r\n  // Password validation\r\n  const isValidPassword = (password: string): boolean => {\r\n    return password.length >= 6\r\n  }\r\n\r\n  // Form validation\r\n  const validateForm = (): boolean => {\r\n    const errors: ValidationErrors = {}\r\n\r\n    // Email validation\r\n    if (!formData.email) {\r\n      errors.email = \"Email address is required\"\r\n    } else if (!isValidEmail(formData.email)) {\r\n      errors.email = \"Please enter a valid email address\"\r\n    }\r\n\r\n    // Password validation\r\n    if (!formData.password) {\r\n      errors.password = \"Password is required\"\r\n    } else if (!isValidPassword(formData.password)) {\r\n      errors.password = \"Password must be at least 6 characters long\"\r\n    }\r\n\r\n    // Name validation for signup\r\n    if (isSignUp && !formData.name.trim()) {\r\n      errors.name = \"Full name is required for account creation\"\r\n    }\r\n\r\n    setValidationErrors(errors)\r\n    return Object.keys(errors).length === 0\r\n  }\r\n\r\n  // Clear error message after a delay\r\n  const clearMessages = () => {\r\n    setTimeout(() => {\r\n      setErrorMessage(null)\r\n      setSuccessMessage(null)\r\n    }, 5000)\r\n  }\r\n\r\n  // Set error message\r\n  const setError = (type: ErrorMessage['type'], message: string) => {\r\n    setErrorMessage({ type, message })\r\n    clearMessages()\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    \r\n    // Clear previous messages\r\n    setErrorMessage(null)\r\n    setSuccessMessage(null)\r\n    \r\n    // Validate form\r\n    if (!validateForm()) {\r\n      return\r\n    }\r\n\r\n    setLoading(true)\r\n\r\n    try {\r\n      if (isSignUp) {\r\n        await handleSignUp()\r\n      } else {\r\n        await handleSignIn()\r\n      }\r\n    } catch (error) {\r\n      console.error('Authentication error:', error)\r\n      setError('error', 'An unexpected error occurred. Please try again.')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleSignUp = async () => {\r\n    try {\r\n      const response = await fetch('/api/signup', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          ...formData,\r\n          role: \"SITE_MANAGER\" // Default role, not user-selectable\r\n        })\r\n      })\r\n\r\n      const data = await response.json()\r\n\r\n      if (response.ok) {\r\n        setSuccessMessage('Account created successfully! Redirecting to dashboard...')\r\n        \r\n        // Auto sign in after successful signup\r\n        setTimeout(async () => {\r\n          const result = await signIn(\"credentials\", {\r\n            email: formData.email,\r\n            password: formData.password,\r\n            redirect: false\r\n          })\r\n          \r\n          if (result?.ok) {\r\n            router.push('/dashboard')\r\n          }\r\n        }, 1500)\r\n      } else {\r\n        // Handle specific signup errors\r\n        switch (response.status) {\r\n          case 400:\r\n            if (data.message?.includes('Email already exists')) {\r\n              setError('error', 'An account with this email address already exists. Please use a different email or try signing in.')\r\n            } else {\r\n              setError('error', data.message || 'Failed to create account. Please check your information and try again.')\r\n            }\r\n            break\r\n          case 422:\r\n            setError('error', 'Please check your information and try again.')\r\n            break\r\n          default:\r\n            setError('error', 'Failed to create account. Please try again later.')\r\n        }\r\n      }\r\n    } catch {\r\n      setError('error', 'Network error. Please check your internet connection and try again.')\r\n    }\r\n  }\r\n\r\n  const handleSignIn = async () => {\r\n    try {\r\n      console.log('Attempting to sign in with:', { email: formData.email, password: formData.password.substring(0, 3) + '...' })\r\n      \r\n      // Get client info for session management\r\n      const ipAddress = '127.0.0.1' // In production, this would come from headers\r\n      const userAgent = navigator.userAgent || 'Unknown Browser'\r\n      \r\n      const result = await signIn(\"credentials\", {\r\n        email: formData.email,\r\n        password: formData.password,\r\n        redirect: false\r\n      })\r\n\r\n      console.log('SignIn result:', result)\r\n\r\n      // Check if sign in was successful\r\n      if (result && result.ok && !result.error) {\r\n        // Create session for successful login\r\n        const session = await SessionManager.createSession(\r\n          'user_from_login', // We'll get the actual user ID from the session\r\n          `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n          undefined, // No refresh token for credential login\r\n          'Web Browser',\r\n          ipAddress,\r\n          userAgent\r\n        )\r\n\r\n        console.log('Session created for user:', session.id)\r\n\r\n        // Log successful login to audit system\r\n        await SimpleAuditLogger.logLoginAttempt(\r\n          'user_from_login',\r\n          formData.email,\r\n          true,\r\n          ipAddress,\r\n          userAgent\r\n        )\r\n\r\n        setSuccessMessage('Welcome back! Redirecting to dashboard...')\r\n        setTimeout(() => {\r\n          router.push('/dashboard')\r\n        }, 1000)\r\n      } else {\r\n        // Handle sign-in failures\r\n        const errorMessage = result?.error || 'Sign in failed'\r\n        \r\n        console.log('Sign in failed with error:', errorMessage)\r\n        \r\n        // Log failed login to audit system\r\n        await SimpleAuditLogger.logLoginAttempt(\r\n          undefined,\r\n          formData.email,\r\n          false,\r\n          ipAddress,\r\n          userAgent,\r\n          errorMessage\r\n        )\r\n        \r\n        // More specific error handling\r\n        if (!result) {\r\n          setError('error', 'Authentication service is unavailable. Please try again later.')\r\n        } else if (result.error) {\r\n          switch (result.error) {\r\n            case 'CredentialsSignin':\r\n            case 'InvalidLogin':\r\n            case 'Invalid credentials':\r\n              setError('error', 'Invalid email or password. Please check your credentials and try again.')\r\n              break\r\n            case 'User not found':\r\n            case 'User not found.':\r\n              setError('error', 'No account found with this email address. Please check your email or create a new account.')\r\n              break\r\n            case 'Invalid password':\r\n              setError('error', 'The password you entered is incorrect. Please try again.')\r\n              break\r\n            case 'Email not verified':\r\n              setError('error', 'Please verify your email address before signing in.')\r\n              break\r\n            case 'Too many requests':\r\n              setError('error', 'Too many login attempts. Please wait a few minutes before trying again.')\r\n              break\r\n            default:\r\n              // Generic error handling\r\n              if (errorMessage.toLowerCase().includes('password') || errorMessage.toLowerCase().includes('credentials')) {\r\n                setError('error', 'Invalid email or password. Please check your credentials and try again.')\r\n              } else if (errorMessage.toLowerCase().includes('network') || errorMessage.toLowerCase().includes('fetch')) {\r\n                setError('error', 'Network error. Please check your internet connection and try again.')\r\n              } else if (errorMessage.toLowerCase().includes('user') || errorMessage.toLowerCase().includes('email')) {\r\n                setError('error', 'No account found with this email address. Please check your email or create a new account.')\r\n              } else {\r\n                setError('error', `Sign in failed: ${errorMessage}`)\r\n              }\r\n          }\r\n        } else {\r\n          setError('error', 'Sign in failed. Please try again.')\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Sign in error:', error)\r\n      \r\n      // Log unexpected errors to audit system\r\n      await SimpleAuditLogger.logLoginAttempt(\r\n        undefined,\r\n        formData.email,\r\n        false,\r\n        '127.0.0.1',\r\n        navigator.userAgent || 'Unknown Browser',\r\n        error instanceof Error ? error.message : 'Unknown error'\r\n      )\r\n      \r\n      setError('error', 'Network error. Please check your internet connection and try again.')\r\n    }\r\n  }\r\n\r\n  const handleGoogleSignIn = async () => {\r\n    setLoading(true)\r\n    setErrorMessage(null)\r\n    \r\n    try {\r\n      await signIn('google', { callbackUrl: '/dashboard' })\r\n    } catch {\r\n      setError('error', 'Google sign-in failed. Please try again.')\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const switchMode = () => {\r\n    setIsSignUp(!isSignUp)\r\n    setErrorMessage(null)\r\n    setSuccessMessage(null)\r\n    setValidationErrors({})\r\n    setFormData({\r\n      email: \"\",\r\n      password: \"\",\r\n      name: \"\"\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n      <div className=\"max-w-md w-full space-y-8 border border-gray-300 rounded-lg p-8 bg-white shadow-sm\">\r\n        <div>\r\n          <div className=\"flex justify-center\">\r\n            <div className=\"bg-blue-100 rounded-full p-3\">\r\n              <svg className=\"w-8 h-8 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h3M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n          <h1 className=\"mt-4 text-center text-2xl font-bold text-gray-900\">\r\n            APM Asset Management\r\n          </h1>\r\n          <p className=\"mt-2 text-center text-sm text-gray-600\">\r\n            {isSignUp ? 'Create your account to get started' : 'Sign in to manage your assets'}\r\n          </p>\r\n        </div>\r\n\r\n        <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\r\n          {/* Error Message */}\r\n          {errorMessage && (\r\n            <div className={`rounded-md p-4 ${\r\n              errorMessage.type === 'error' ? 'bg-red-50 border border-red-200 text-red-700' :\r\n              errorMessage.type === 'warning' ? 'bg-yellow-50 border border-yellow-200 text-yellow-700' :\r\n              'bg-green-50 border border-green-200 text-green-700'\r\n            }`}>\r\n              <div className=\"flex\">\r\n                <div className=\"shrink-0\">\r\n                  {errorMessage.type === 'error' ? (\r\n                    <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\r\n                    </svg>\r\n                  ) : errorMessage.type === 'warning' ? (\r\n                    <svg className=\"h-5 w-5 text-yellow-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                      <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\r\n                    </svg>\r\n                  ) : (\r\n                    <svg className=\"h-5 w-5 text-green-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                    </svg>\r\n                  )}\r\n                </div>\r\n                <div className=\"ml-3\">\r\n                  <p className=\"text-sm font-medium\">{errorMessage.message}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Success Message */}\r\n          {successMessage && (\r\n            <div className=\"rounded-md bg-green-50 p-4 border border-green-200\">\r\n              <div className=\"flex\">\r\n                <div className=\"shrink-0\">\r\n                  <svg className=\"h-5 w-5 text-green-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                </div>\r\n                <div className=\"ml-3\">\r\n                  <p className=\"text-sm font-medium text-green-800\">{successMessage}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"space-y-4\">\r\n            {/* Name Field (Sign Up Only) */}\r\n            {isSignUp && (\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">\r\n                  Full Name <span className=\"text-red-500\">*</span>\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  required={isSignUp}\r\n                  className={`mt-1 block w-full border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${\r\n                    validationErrors.name ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n                  }`}\r\n                  placeholder=\"Enter your full name\"\r\n                  value={formData.name}\r\n                  onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}\r\n                />\r\n                {validationErrors.name && (\r\n                  <p className=\"mt-1 text-sm text-red-600\">{validationErrors.name}</p>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Email Field */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700\">\r\n                Email Address <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <input\r\n                type=\"email\"\r\n                required\r\n                className={`mt-1 block w-full border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${\r\n                  validationErrors.email ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n                }`}\r\n                placeholder=\"Enter your email address\"\r\n                value={formData.email}\r\n                onChange={(e) => {\r\n                  setFormData(prev => ({ ...prev, email: e.target.value }))\r\n                  if (validationErrors.email) {\r\n                    const { email, ...restErrors } = validationErrors\r\n                    setValidationErrors(restErrors)\r\n                  }\r\n                }}\r\n              />\r\n              {validationErrors.email && (\r\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.email}</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Password Field */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700\">\r\n                Password <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <input\r\n                type=\"password\"\r\n                required\r\n                className={`mt-1 block w-full border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${\r\n                  validationErrors.password ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n                }`}\r\n                placeholder={isSignUp ? \"Create a password (min. 6 characters)\" : \"Enter your password\"}\r\n                value={formData.password}\r\n                onChange={(e) => {\r\n                  setFormData(prev => ({ ...prev, password: e.target.value }))\r\n                  if (validationErrors.password) {\r\n                    const { password, ...restErrors } = validationErrors\r\n                    setValidationErrors(restErrors)\r\n                  }\r\n                }}\r\n              />\r\n              {validationErrors.password && (\r\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.password}</p>\r\n              )}\r\n              {isSignUp && !validationErrors.password && formData.password && (\r\n                <p className=\"mt-1 text-sm text-gray-500\">\r\n                  Password must be at least 6 characters long\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Role Field (Sign Up Only) - Removed role selection */}\r\n            {isSignUp && (\r\n              <div>\r\n                <p className=\"text-sm text-gray-500\">\r\n                  Your account will be created with standard permissions.\r\n                  System administrators can adjust your access level if needed.\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"space-y-3\">\r\n            {/* Primary Submit Button */}\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {loading ? (\r\n                <>\r\n                  <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                  </svg>\r\n                  Please wait...\r\n                </>\r\n              ) : (\r\n                isSignUp ? 'Create Account' : 'Sign In'\r\n              )}\r\n            </button>\r\n\r\n            {/* Divider */}\r\n            <div className=\"relative\">\r\n              <div className=\"absolute inset-0 flex items-center\">\r\n                <div className=\"w-full border-t border-gray-300\" />\r\n              </div>\r\n              <div className=\"relative flex justify-center text-sm\">\r\n                <span className=\"px-2 bg-white text-gray-500\">Or</span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Google Sign In Button */}\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleGoogleSignIn}\r\n              disabled={loading}\r\n              className=\"w-full flex justify-center items-center py-3 px-4 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50\"\r\n            >\r\n              <svg className=\"w-5 h-5 mr-2\" viewBox=\"0 0 24 24\">\r\n                <path fill=\"#4285F4\" d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"/>\r\n                <path fill=\"#34A853\" d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"/>\r\n                <path fill=\"#FBBC05\" d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"/>\r\n                <path fill=\"#EA4335\" d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"/>\r\n              </svg>\r\n              Continue with Google\r\n            </button>\r\n          </div>\r\n\r\n          {/* Switch Mode Link */}\r\n          <div className=\"text-center\">\r\n            <p className=\"text-sm text-gray-600\">\r\n              {isSignUp ? 'Already have an account?' : \"Don't have an account?\"}\r\n              {' '}\r\n              <button\r\n                type=\"button\"\r\n                onClick={switchMode}\r\n                className=\"font-medium text-blue-600 hover:text-blue-500\"\r\n                disabled={loading}\r\n              >\r\n                {isSignUp ? 'Sign in here' : 'Create an account'}\r\n              </button>\r\n            </p>\r\n          </div>\r\n\r\n          {/* Footer Links */}\r\n          <div className=\"text-center space-y-2\">\r\n            <p className=\"text-xs text-gray-500\">\r\n              By {isSignUp ? 'creating an account' : 'signing in'}, you agree to our terms of service and privacy policy.\r\n            </p>\r\n            {isSignUp && (\r\n              <div className=\"flex justify-center space-x-4 text-xs text-gray-500\">\r\n                <Link href=\"/help\" className=\"hover:text-gray-700\">Help & Support</Link>\r\n                <span></span>\r\n                <Link href=\"/privacy\" className=\"hover:text-gray-700\">Privacy Policy</Link>\r\n                <span></span>\r\n                <Link href=\"/terms\" className=\"hover:text-gray-700\">Terms of Service</Link>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}